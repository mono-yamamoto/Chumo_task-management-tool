---
title: "/commit"
description: "変更を関連ごとに自動コミット（1コミット=1事柄）。確認なしで実行。"
---

あなたはリポジトリ直下で実行される自動コミットアシスタントです。以下のルールで、変更を関連ごとにグルーピングし、各グループを1コミットに分割して即時コミットしてください。確認ダイアログは不要です。

### 目的
- 1コミット=1事柄の原則を厳守し、変更を意味単位で分割コミットする。
- 本リポジトリのコミット規約と絵文字・スコープルールに従い、適切な日本語のメッセージを自動生成する。

### コミットメッセージ規約（必須）
- 形式: `<絵文字> <type>(<scope>): <説明> (#<issue>)`
- 言語: 日本語（技術用語の英語可）
- 1行目は50文字以内に要約
- 補足が必要な場合は、1行目の後に空行を挟み、箇条書きで詳細を記載
  - 変更の背景や理由
  - 影響範囲や注意点
  - 関連する変更や依存関係
  - その他、コミットの理解に役立つ情報
- タイプと絵文字:
  - `✨ feat` 新機能
  - `🐛 fix` バグ修正
  - `📝 docs` ドキュメント
  - `💄 style` 見た目/体裁のみ（動作影響なしのCSSや整形）
  - `♻️ refactor` リファクタリング
  - `✅ test` テスト
  - `🔧 build` ビルド/配布/スクリプト
  - `👷 ci` CI/CD
  - `🚀 perf` パフォーマンス改善
  - `⚙️ chore` その他、依存/設定更新
- Issue番号は現在のブランチ名から数字を抽出し `(#<番号>)` を末尾に付与（存在する場合）。

### グルーピング規則（1コミット=1事柄）
変更ファイルを以下のキーでグループ化し、各グループを1コミットにする。
- キー: `<scope>|<area>`
- scope 判定:
  - `packages/<pkg>/...` → `<pkg>` をスコープにする（`pet_DLP` は `pet` に正規化）
  - それ以外は先頭ディレクトリ名、なければ `root`
- area 判定（packages 配下）:
  - `package.json` → `pkgjson`
  - `lib/build/**`, `scripts/**` → `build`
  - `src/pages/**` → `pages`
  - `src/**` → `src`
  - 上記以外 → `other`
- packages 外は `other`（ルート直下の `package.json` は `root|pkgjson`）

### type 推定ヒューリスティクス（ガイド）
- `pkgjson` → `⚙️ chore`
- `build` → `🔧 build`
- `pages` → 主に UI/機能追加なら `✨ feat`、CSSのみなら `💄 style`
- `src` → パフォーマンス改善が読み取れれば `🚀 perf`、単純な整理は `♻️ refactor`、明確な不具合修正は `🐛 fix`
- `other` → 迷ったら `⚙️ chore`

### 実行手順
1) ルートに移動し、変更がなければ終了。
2) 既存のステージをリセット（作業ツリーは変更しない）。
3) `git status --porcelain` を解析し、上記規則でグルーピング。
4) 各グループについて順に:
   - そのグループのファイルのみステージ（削除/リネーム含む: `git add -A -- <file>`）。
   - 差分から要旨を把握し、規約に従う1行メッセージを生成。
   - 補足が必要な場合は、空行を挟んで箇条書きで詳細を追加（変更の背景、影響範囲、注意点など）。
   - ブランチ名から Issue 番号を抽出し、存在すれば末尾に `(#<番号>)` を付与。
   - `git commit -m "<生成メッセージ>"` を実行（複数行の場合は `-m` を複数回使用）。
5) すべてのグループが完了したら、コミット一覧の簡潔な要約を表示。

### 厳守事項
- 確認や質問を挟まず、自動でコミットまで完了する（ノンインタラクティブ）。
- 1つのコミットに複数の無関係変更を混在させない。
- ファイルパスは必ずクォートし、`git add -A --` を用いて削除/リネームも取りこぼさない。
- エラーが発生したグループで処理を停止し、どのグループで失敗したかを短く報告。

### 例（出力イメージ）

**シンプルな場合（補足不要）:**
- `✨ feat: 見積りトップのUI改善 (#266)`
- `🔧 build: dist書き換えスクリプトを更新 (#266)`

**補足が必要な場合:**
```
✨ feat(auth): ログイン処理の改善 (#123)

- セッションタイムアウトの処理を追加
- エラーハンドリングを強化
- 既存の認証フローとの互換性を維持
```

```
♻️ refactor(tasks): タスク一覧のパフォーマンス最適化 (#456)

- 仮想スクロールを導入して大量データに対応
- メモ化を適用して再レンダリングを削減
- 既存のフィルタリング機能に影響なし
```

